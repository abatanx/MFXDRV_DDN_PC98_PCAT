

mPlus(mfxc+) user's manual                                       ver.1.18DOC



mplus.doc
----------------------------------------------------------------------------
DOS汎用音源ドライバ(XMML3.00仕様) Music Macro Language Compiler system
                       MFXDRV/DDN compiler MFXC Ver.3
                    mPlus(mfxc+) version 1.18 release 3.1
            copyright (c) 1991-95 by T.Kobayashi / Interfair(DIL)
                            all rights reserved.

----------------------------------------------------------------------------






                               第1章  はじめに



    ○どもども
          このたびは、MFXDRV/DDN(XMML3.00仕様)用のMMLコンパイラ mPlus をダウ
        ンロードしていただき、誠にありがとうござります。本ソフトウェアは音源
        ドライバ  MFXDRV/DDN  をフルに活用できるような言語仕様にしてますが一
        部、 かなりの不備もあります(笑)。おまけにちょっと不安定です(笑)(って
        おい...)。遊びがてら何かつくってみて、なにか不満がありましたら、私ま
        でご連絡下さればできるたけの対処を致しますので、これからもよろしくお
        ねがいします。ぐう。

    ○mPlus(mfxc+)の特徴

         1. XMML2.00コンパイラ、mfxc.exeとの互換性が全くない(笑)。

         2. おもいっきり複雑なことが出来るマクロ(笑)

         3. １ファイル中に、何曲も曲を作成できる。

         4. C だか Pascal に似た、なんだかよく分からないsyntax(笑)。

         5. マクロ展開時に演算も可能。

         6. トラックごとに和音もつくれる。keyの設定も簡単。

         7. 一応1パスコンパイラで速いはずなのだが、和音 & ゲート処理のため、
            コンパイル速度がちょっと遅い。

         8. ほとんどの機能を動的なメモリー構造にしているので(スタック以外)、
            メモリーが許す限り、マクロ登録、マクロ再帰呼び出し、再帰的インク
            ルードなどが可能。

         9. 動作が多少不安定(T_T)

        ということで、あまり冴えないコンパイラです^^;;

※動作機種等



                                   - 1 -                             DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


    ○動作機種
        DOSのアプリケーションが動作する80186以降のCPUを搭載した機種。 開発は
        PC-9801RA21(Cx486DRx2)上で行いました。

    ○動作OS
        MS-DOS  version 3.10 以降、または同等以上の機能を持つ OS上で動作しま
        す。

    ○必要メモリ
        本コンパイラは、ソースファイルや、マクロ定義の多さなどによりますが、
        最低でも、約200k程度のメモリーが必要です。また、マクロ及びファイルの
        include、計算処理などはすべて動的な構造にしているので、メモリーが0に
        なるまで定義、計算、及びincludeすることができます。

※インストール

    ○必要ファイル
        デフォルトで以下のファイルがまとめられています。

             mplus.doc       本ファイル
             mplus.exe       mPlus コンパイラ本体
             include.lzh     インクルードマクロファイル集
             src.lzh         ソースプログラム


        デフォルトでMFXDRV/DDNシステムが使用する拡張子の意味を定義しておきま
        す。

             〜.exe 〜.com   各種実行プログラム
             〜.xdv          XDVドライバ(音源、タイマ、その他)
             〜.mud          楽曲ファイル(演奏可能)
             〜.eud          効果音ファイル
             〜.mbs          ソースオブジェクト
             〜.mbj          オブジェクト
             〜.sbj          音色オブジェクト
             〜.lis          音色ライブラリ
             〜.mmd          mPlus MMLスクリプト
             〜.mac          mPlus MML マクロスクリプト




















                                   - 2 -                             DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC








                                 第2章  文法


          基本的に以下の 3つの文体系になっています。

         1.   # で始まる文(システム制御およびコンパイル制御命令)

         2.   . で始まる文(オブジェクト制御命令)

         3.   コメント


          以下コマンドまたは命令は、次のような書き方で説明を行っていきます。

        > <> 省略できないパラメータ
        > [] 省略できるパラメータ
        > .. 繰り返して指定できる
        > "" 括弧内をそのまま書く
        > A|B A 若しくは B

































                                   - 3 -                             DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


    ○コメント
          コメントは、行頭に ; もしくは * を書くことによって、それ以下に記述
        することができます。ただし、トラック状態記述部や、 MML内には書くこと
        が出来ません。 もし、記述したい場合は、/* ... */ を使用して下さい(こ
        のコメントはあらゆるところで有効)。





















































                                   - 4 -                             DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


    ○# で始まる文(システム制御命令)
          #  で始まる命令は、 主にコンパイル動作や、 MML則等を制御する命令で
        す。このシステム制御命令は、1行ごとにチェックしていくため、必ず1行に
        1命令を置いて下さい。

          書式は

             #システム制御命令名  パラメータ...


+-----------------------------------------------------------------------+
|命令                          |機能／解説                              |
|------------------------------+----------------------------------------|
|#timebase <number>            |タイムベースを <number> で設定した値にし|
|                              |ます。通常は 48 です。                  |
|------------------------------+----------------------------------------|
|#title <title>                |曲のタイトルを <title> に設定します。   |
|------------------------------+----------------------------------------|
|#composer <composer>          |作曲者を <composer> に設定します。      |
|------------------------------+----------------------------------------|
|#arranger <arranger>          |編曲者を <arranger> に設定します。      |
|------------------------------+----------------------------------------|
|#lyric <lyric>                |作詞者を <lyric> に設定します。         |
|------------------------------+----------------------------------------|
|#artist <artist>              |アーティスト名を <artist> に設定します。|
|------------------------------+----------------------------------------|
|#copyright <copyright>        |著作権保有者を   <copyright>  に設定しま|
|                              |す。                                    |
|------------------------------+----------------------------------------|
|#include <filename>           |<filename> で示されたファイルを、 この命|
|                              |令が記述されている位置に挿入します。  ま|
|                              |た、 挿入されたファイルの中に #include命|
|                              |令が存在している場合、再帰的にメモリーが|
|                              |許す限り実行していきます。              |
|------------------------------+----------------------------------------|
|#define <mac1> [mac2]         |展開前を<mac1>、展開後を[mac2]としたマク|
|                              |ロを登録します。[mac2]がない場合名前のみ|
|                              |を展開前の名前のみを登録します。        |
|------------------------------+----------------------------------------|
|#def                          |前の  #defineと機能は同じですが、 <mac1>|
|<mac1>                        |及び <mac2> が長い場合、この命令を使用し|
|#nextdef                      |て下さい。途中のreturnコード、スペース、|
|<mac2>                        |tabなどは削除(ただし、ダブルクォーテーシ|
|#enddef                       |ョン内はそのまま)されます。 <mac1>  及び|
|                              |<mac2>    ともに最大4096文字を記述可能で|
|                              |す。                                    |
|------------------------------+----------------------------------------|
|#ifdef <macroname>            |<macroname> で与えられたマクロが #define|
|                              |で登録されていたら、     〜#endif,#else,|
|                              |#elseifまでをコンパイル可能にします。 も|
|                              |し登録されていなかったら無視します。    |
|------------------------------+----------------------------------------|
|#ifndef <macroname>           |<macroname> で与えられたマクロが #define|
|                              |で登録されていなかったら、あとは#ifdefと|
|                              |同じ動作を行います。                    |
|------------------------------+----------------------------------------|


                                   - 5 -                             DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


|#else                         |#ifdef,#ifndef〜#else までコンパイルされ|
|                              |ていなかったら #else〜#endifまでコンパイ|
|                              |ルし、コンパイルされていなかったら #else|
|                              |〜#endifまでコンパイルします。          |
|------------------------------+----------------------------------------|
|#elseif <macroname>           |<macroname> で与えられたマクロが #define|
|                              |で登録されていたら #elseと同じ動作を行い|
|                              |ます。                                  |
|------------------------------+----------------------------------------|
|#endif                        |条件コンパイルの範囲を終了します。      |
|------------------------------+----------------------------------------|
|#precede <DRVID> <objectname> |もし、 <DRVID>と一致するドライバが組み込|
|                              |まれていたら、優先的に<objectname>で与え|
|                              |られた曲データの演奏を開始します。このコ|
|                              |マンドは、いくつでも指定することができ、|
|                              |演奏時は最初に書かれたものから調べてい  |
|                              |き、   最後まで<DRVID>が一致しなかった場|
|                              |合、_main を演奏します。                |
|------------------------------+----------------------------------------|
|#message <message>            |<message> を標準出力に出力します。      |
|------------------------------+----------------------------------------|
|#memo 〜 //                   |#memo から // の間に記述されたメッセージ|
|                              |を、 メモとして  mbs  ファイルに出力しま|
|                              |す。                                    |
+-----------------------------------------------------------------------+

































                                   - 6 -                             DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


    ○. で始まる文(オブジェクト制御命令)
          .で始まる命令は、.objectです。

          オブジェクトとは曲データを構成する要素をしめします。なぜ、このよう
        な面倒臭い概念があるのか。理由は簡単。MFXDRV/DDN は、MIDIでもOPNでも
        すべて同じMMLで制御できます。 しかし、MIDIで記述したドラムパートと、
        OPNで記述するドラムパートの書き方というのは基本的に全然違うでしょ
        う。MIDIの場合、各ノートがドラム／パーカッションの１つ１つに対応して
        いますが、OPNでは、音色を切り替えてnote-Onで発声させてやる必要があり
        ます。つまり、この違いをなんとか押さえるために、このような概念がある
        わけです。ほかにもいろいろな使い方があります(^^)。

          次に トラック状態 というのは、melodyはこの音源で鳴らせとか、bassは
        あの音源でならせとか、もしMIDIが鳴らせるなら違うオブジェクトのトラッ
        クxを鳴らせなどの、トラックと音源、 オブジェクトの関係を設定したもの
        です。まぁ、そんなに難しく考える必要はありません。

          書式は

              .object <オブジェクト名> <トラック状態> {MML....}


          オブジェクト名は31文字まで、 使用できる文字は 0〜9,A〜Z,a〜z,_,.で
        す。またオブジェクト名の最初の文字は必ず _ を付加してください。
          曲データが１つしか無い場合、オブジェクト名は必ず _main  にする必要
        があります。 C言語で最初に実行される関数が int main() であるのと同じ
        ようなものです(笑)。

          トラック状態は、次の書式です。

             トラック名 = 音源1(Ch1),音源2(Ch2),音源3(Ch3),音源4(Ch4);


          トラック名で与えられたチャンネルは、これこれの音源で演奏しなさい、
        という感じですね。音源1 [*1] (Ch1 [*2] )をチェックして、それが使えな
        いなら音源2(Ch2)へというように処理され、 音源4をチェックしてそれが使
        用不可の場合、そのトラックは演奏されません。
          また、音源(Ch)に *COND 、OFF というのも使用できます。
          *COND は、Conductorの略で、演奏されなかったら非常に困るMMLがあるト
        ラック(たとえば、テンポとかマスターボリュームとか音色定義とかです)を
        示すものです。この場合、演奏(コントロール)は強制的になにかの音源に自
        動的に割り当てられます。
          OFF は、演奏するな！という命令です。

          最後にMMLの書き方です。次の書式です。

             トラック名  MML列;


-- note -----------------

 [*1] ここで、音源とは DRVID のことを指します。DRVIDについては、MFXDDNのドキ
      ュメントを参照してください。

 [*2] Channel(チャンネル)の略。MIDIは1〜16のトラックがあるので、 Chは0〜15に
      なる。つまり、Chが9のとき、ドラムパート。


                                   - 7 -                             DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


          トラック名は、先ほどトラック状態で設定したトラック名を指定します。
        このトラックは、このMMLを実行しろ、という感じですね。
          MML列は最後に ; がくるまで、コンパイルし続けます。途中改行などが存
        在しても構いません。 ただし、MML列の中にコメントを設定することはでき
        ないので注意して下さい。

          なんだかよくわかんない人のために(笑)、例をあげておきます。このよう
        に書いて下さい。

    (例)テンポ=128で、コードCMをMIDIのCh0で、ベースをMIDIのCh1で鳴らしたい。

          .object _main
          cond  = *COND;
          chord = MIDI(0),OFF;
          bass  = MIDI(1),OFF;
          {
              cond   t128;
              chord  @0v15o5l1x127q127 'ceg'1;
              bass   @1v15o3l8x127q127 [2c>c<];
          }

    ○MML列について
          MML列には、以下のコマンド[*3]が使用可能です。


    ------------------------------------------------------------------------
    【1】ノート(音符,休符)関係

    書式:<音程>[音程修飾子] [音長][音長修飾子] [/[ゲートタイム比][/<ベロシテ
    ィ]] [付加修飾子]
    例1(付点4分音符でドレ#ミb):c4.d#4.e-4.
    例2(ゲートタイム40% 60% 80%で、例1と同じ発声):c4./40d#4./60e-4./80
    例3(ベロシティ90 100 110で、例1と同じ発声):c4.//90d#4.//100e-4.//110
    例4(例2+例3):c4./40/90d#4./60/100e-4./80/110

    +-------------------------------------------------------------------+
    |<音程>              |c,d,e,f,g,a,b,r  |左から、 ドレミファソラシ,休|
    |                    |                 |符に対応しています。        |
    |--------------------+-----------------+----------------------------|
    |<音程修飾子>        |#,+, -, *        |左からシャープ(半音上げる)、|
    |                    |                 |フラット(半音下げる)、ナチュ|
    |                    |                 |ラル(半音を戻す)に対応してい|
    |                    |                 |ます。なお、#と+は機能的には|
    |                    |                 |全く同じものです。          |
    |--------------------+-----------------+----------------------------|
    |<音長>              |1〜64            |音長を設定します。4分音符(休|
    |                    |                 |符)なら4、 付点8分音符(休符)|
    |                    |                 |なら8というふうに記述して下 |
    |                    |                 |さい。                      |
    |--------------------+-----------------+----------------------------|
    |<音長修飾子>        |.                |付点を設定します。連続して記|
    |                    |                 |述できますが、あまり多く連続|
    |                    |                 |付点を指定するとタイムベース|
    |                    |                 |が小さいとき、テンポずれが発|
    |                    |                 |生することがあります。この場|
    |                    |                 |合警告[*4]が表示されます。  |


                                   - 8 -                             DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


    |--------------------+-----------------+----------------------------|
    |<ｹﾞｰﾄﾀｲﾑ比>         |1〜32767         |音長(ステップタイム)に対する|
    |                    |                 |ゲートタイムの割合を設定しま|
    |                    |                 |す。単位は、 %(パーセント)で|
    |                    |                 |す。                        |
    |--------------------+-----------------+----------------------------|
    |<ベロシティ>        |1〜127           |ベロシティ(鍵盤を叩く強さ)を|
    |                    |                 |設定します。1〜127です。 0は|
    |                    |                 |休符を示すので許可していませ|
    |                    |                 |ん。                        |
    |--------------------+-----------------+----------------------------|
    |<付加修飾子>        |&,^              |次のノートとつなげます      |
    |                    |                 |(tie)。 次のノートが違う音程|
    |                    |                 |の場合警告が表示されます。  |
    +-------------------------------------------------------------------+


    ------------------------------------------------------------------------
    【2】和音関係

    書式:"'"<MML列>"'"[音長][音長修飾子]

    例(CMaj7):'cegb'4.

      <MML列>内にあるノートを同時に発声します。なお、<MML列>内に存在するノー
    トに付加された音長はゲートタイムに相当し、また、''外に付加された音長など
    はステップタイムに相当しますので注意して下さい。


    ------------------------------------------------------------------------
    【3】連符制御

    書式:{[音長][音長修飾子]/<分割数><MML列>}

    例(3連符:2分音符を3つに分けるという意味):{2/3cde}

      [音長][音長修飾子]を<分割数>で割り、 その長さを<MML列>内にあるノートに
    振り分けます。<MML列>内のノートに音長などが記述してあった場合無視(警告を
    表示)されます。


    ------------------------------------------------------------------------
    【4】繰り返し

    書式:"["<数値><MML列>[":"]<MML列>"]"

    例1(4回ドレミを繰り返す):[4cde]
    例2(3回ドレミを繰り返して、最後はドレﾌｧ):[4cd:e]f
    例3(4回ドレドレドレミ):[4[2cd]cde]

      <数値>回数だけ [...] 内を繰り返します。<数値>が0の時は無限ループになり
    ます。 なお、 <MML列>内に ":" が存在した場合最後の1ループ時に、":"以降の
    MMLをとばして繰り返しを抜けます。また、例3のような繰り返しのネストも使用
    可能です。




                                   - 9 -                             DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


    ------------------------------------------------------------------------
    【5】調設定

    書式:%<c|d|e|f|g|a|b>...%<#|+|->

    例(Dmaj):%cf%+

      %...% 内にある音程をデフォルトで #,+,-(シャープまたはフラット)に設定し
    ます。この命令は1トラック毎に有効です。なお、 ノートで臨時的にこの効果を
    消したい場合は、ナチュラル "*" を使用して下さい。


    ------------------------------------------------------------------------
    【6】定数的なマクロ展開

    書式:(<マクロ名>)

    例:

         #define  Cmaj  %%+
         #define  C7    (Cmaj)'cega+'
              :
         Melody t128l8o5(C7);
         これは、
         Melody t128l8o5%%+'cega+'
         と展開される。

      #def または #define で設定したマクロを展開します。再帰的なマクロも正常
    に展開します。


    ------------------------------------------------------------------------
    【7】定数的なマクロ展開(簡易表記)

    書式:!<1文字>

    例:

         #define  Snaredrum  1
         #define  s          @(Snaredrum)v15c
              :
         Melody t128l8o5!s4!s4!s4!s4;
         これは、
         Melody t128l8o5@1v15c4@1v15c4@1v15c4@1v15c4;
         と展開される。

      #def または #define で設定したマクロのマクロ名が1文字の場合、!コマンド
    が使用できます。再帰的なマクロも正常に展開します。なお、このコマンドでは
    次の手続き的マクロは使用できません。


    ------------------------------------------------------------------------
    【8】Procedure的なマクロ展開

    書式:(<マクロ名>(<パラメータ>,...))



                                   - 10 -                            DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


    例:

         #define                                  Alpegio4(P1,P2,P3,P4)
         P1P2P3P4>P1P2P3P4P3P2P1<P4P3P2P1<P4>
              :
         Melody t128l8o5(Alpegio4(c,e,g,a+));
         これは、
         Melody t128l8o5cega+>cega+gec<a+gec<a+>;
         と展開される。

      #def  または #define で設定した手続き的マクロを展開します。#defineでパ
    ラメータを例のように設定し、パラメータで展開後の構成を記述するとこのマク
    ロが使用可能になります。なお、パラメータは盲目的に展開していくので、次の
    ようなマクロの動作は保証できません。
    例(だめな例です):

         #define  test2(p,pp)  ppppppppp
         Melody   (test2(c,dd));



    ------------------------------------------------------------------------
    【9】エクスクルーシブメッセージ

    書式:@exc[<10,16進数値及び計算式|sum>, .....];

    例(GMシステムON):@exc[0x7e,0x7f,0x09,0x01];
    例(計算式を用いた例):@exc[0x41,0x10,0x42,0x12,0x30+0x10,0x00,0x7f,0x00,
    sum];

      MIDI音源に対するエクスクルーシブメッセージを送信します。なお、データに
    は10,16進数値及びそれを用いた計算式、またはsumを設定することができます。
    sumを設定した場合、その位置にチェックsumを計算し置き換わるようになってい
    ます。
      また、計算式には以下の演算子を用いることが出来ます。

         2項演算子:
          a+b  加算     a-b  減算     a*b 乗算    a/b 除算    a%b 剰余
          a&b  論理積   a|b  論理和   a^b 排他的論理和
          a>>b 右シフト a<<b 左シフト
         かっこ[*5] :
          {    左かっこ }    右かっこ

    以上の計算式及び手続き的マクロを使用することにより、強力なコントロールマ
    クロを作成することが出来ます。例(GS音源のリバーブ設定マクロ):













                                   - 11 -                            DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


         #define   GS_Reberb(Type)  @exc[0x41,0x10,0x42,0x12,0x40,0x01,
         0x30,Type,sum]
         #define  Reberb_HALL1     3
              :
         Melody t128l8o5(GS_Reberb((Reberb_HALL1)));
         これは、
         Melody t128l8o5@exc[0x41,0x10,0x42,0x12,0x40,0x01,0x30,3,sum];
         と展開される。



    ------------------------------------------------------------------------
    【10】ECM(Extend Contorol Message)制御

    書式:@ecm[<DRVIDNUM>,<DRVTYPE>,<10,16進数値及び計算式|"""文字列
    """>, .....];

    例(歌詞を表示):@exc[0x0001,0x20,0x00,"ぎゃー!しね(笑)。"];

      XMML3.00仕様の外部ドライバに対するメッセージを送信します。DRVIDNUM及び
    DRVTYPEの数値については、 コントロールしたいドライバの説明書をお読み下さ
    い。 データには10,16進数数値、文字列を使用することが出来ます。なお、文字
    列はそのままファイルに書き出されるのでバイナリコメントなどにも使用するこ
    とが出来ます。文字列データを複数書く場合、区切りがありませんので注意して
    下さい。
    例:@ecm[0x1000,0x20,"てすと1","てすと2"]
    これは、ファイルには "てすと1てすと2" と書き出される。ASCIIZな区切りを使
    用したいときは、
    @ecm[0x1000,0x20,"てすと1",0,"てすと2",0]
    という方法で書く必要があります。


    ------------------------------------------------------------------------
    【11】Binary 直接書き出し

    書式:\[<10,16進数値及び計算式>, .....];

    例(チャンネル2に変更):\[0xf1];

    mbj ファイルに直接バイナリを書き出します。mmlbin.doc をご覧下さい。 デー
    タには10,16進数数値を使用することが出来ます。


    ------------------------------------------------------------------------
    【12】音量制御

    +-------------------------------------------------------------------+
    |書式                |数値範囲         |説明                        |
    |--------------------+-----------------+----------------------------|
    |v<数値>             |0〜15            |ボリュームを0(無音)〜15(最  |
    |                    |                 |大)の16段階で設定します。 最|
    |                    |                 |小の時@v0、最大の時@v120に相|
    |                    |                 |当します。                  |
    |--------------------+-----------------+----------------------------|
    |v<<+|->数値>        |-15〜+15         |現在のボリュームを-15〜+15し|
    |                    |                 |ます。                      |


                                   - 12 -                            DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


    |--------------------+-----------------+----------------------------|
    |@v<数値>            |0〜127           |ボリュームを0(無音)〜127(最 |
    |                    |                 |大)の128段階で設定します。 v|
    |                    |                 |コマンドに比べ細かなボリュー|
    |                    |                 |ムの指定が可能です。        |
    |--------------------+-----------------+----------------------------|
    |@v<<+|->数値>       |-127〜+127       |現在のボリュームを-127〜+127|
    |                    |                 |します。                    |
    |--------------------+-----------------+----------------------------|
    |@e<数値>            |0〜127           |エクスプレッションを0(無音) |
    |                    |                 |〜127(最大)の128段階で設定し|
    |                    |                 |ます。                      |
    |--------------------+-----------------+----------------------------|
    |@e<<+|->数値>       |-127〜+127       |現在のエクスプレッションを  |
    |                    |                 |-127〜+127します。          |
    |--------------------+-----------------+----------------------------|
    |@mv<数値>           |0〜127           |マスターボリュームを0(無音) |
    |                    |                 |〜127(最大)の128段階で設定し|
    |                    |                 |ます。曲全体に有効です。トラ|
    |                    |                 |ック毎の設定はできません。  |
    +-------------------------------------------------------------------+


    ------------------------------------------------------------------------
    【13】オクターブ／音長／ゲートタイム／ヴェロシティー制御

    +-------------------------------------------------------------------+
    |書式                |数値範囲         |説明                        |
    |--------------------+-----------------+----------------------------|
    |>                   |なし             |オクターブを1上げます。     |
    |--------------------+-----------------+----------------------------|
    |<                   |なし             |オクターブを1下げます。     |
    |--------------------+-----------------+----------------------------|
    |o<数値>             |0〜7             |オクターブを設定します。    |
    |--------------------+-----------------+----------------------------|
    |l[音長][音長修飾子] |ノート関係を参照 |ノートで音長を省略した場合に|
    |                    |                 |使用するデフォルトを設定しま|
    |                    |                 |す。                        |
    |--------------------+-----------------+----------------------------|
    |q<ゲートタイム比>   |1〜32767         |ノートでゲートタイム比を省略|
    |                    |                 |した場合に使用するデフォルト|
    |                    |                 |を設定します。              |
    |--------------------+-----------------+----------------------------|
    |x<ヴェロシティー>   |1〜127           |ノートでヴェロシティー省略し|
    |                    |                 |た場合に使用するデフォルトを|
    |                    |                 |設定します。                |
    +-------------------------------------------------------------------+


    ------------------------------------------------------------------------
    【14】音色／音色バンク関係

    +-------------------------------------------------------------------+
    |書式                |数値範囲         |説明                        |
    |--------------------+-----------------+----------------------------|
    |@<数値>             |0〜127           |音色を変更します。          |


                                   - 13 -                            DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


    |--------------------+-----------------+----------------------------|
    |@b<10,16進数値>     |0000〜7f7f       |音色バンクを変更します。    |
    +-------------------------------------------------------------------+


    ------------------------------------------------------------------------
    【15】エッフェクタ制御

    +-------------------------------------------------------------------+
    |書式                |数値範囲         |説明                        |
    |--------------------+-----------------+----------------------------|
    |@fr<数値>           |0〜127           |リバーブセンドレベルを変更し|
    |                    |                 |ます。                      |
    |--------------------+-----------------+----------------------------|
    |@fr<<+|->数値>      |-127〜+127       |現在のリバーブセンドレベルを|
    |                    |                 |-127〜+127します。          |
    |--------------------+-----------------+----------------------------|
    |@fc<数値>           |0〜127           |リバーブセンドレベルを変更し|
    |                    |                 |ます。                      |
    |--------------------+-----------------+----------------------------|
    |@fc<<+|->数値>      |-127〜+127       |現在のリバーブセンドレベルを|
    |                    |                 |-127〜+127します。          |
    +-------------------------------------------------------------------+



































                                   - 14 -                            DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


    ------------------------------------------------------------------------
    【16】パン制御

    +-------------------------------------------------------------------+
    |書式                |数値範囲         |説明                        |
    |--------------------+-----------------+----------------------------|
    |@p<数値>            |0〜127           |パンの位置を設定します。64が|
    |                    |                 |中央、0(左)〜127(右)です。  |
    |--------------------+-----------------+----------------------------|
    |@p<<+|->数値>       |-127〜+127       |現在のパンの位置を-127〜+127|
    |                    |                 |します。                    |
    +-------------------------------------------------------------------+


    ------------------------------------------------------------------------
    【17】ビブラート／ポルタメント／ピッチベンド制御

    +-------------------------------------------------------------------+
    |書式                |数値範囲         |説明                        |
    |--------------------+-----------------+----------------------------|
    |m<数値>             |0〜127           |ビブラートレベルを設定しま  |
    |                    |                 |す。                        |
    |--------------------+-----------------+----------------------------|
    |m<<+|->数値>        |-127〜+127       |現在のビブラートレベルを-127|
    |                    |                 |〜+127します。              |
    |--------------------+-----------------+----------------------------|
    |@xp<+|->            |なし             |ポルタメントをon(+)、 off(-)|
    |                    |                 |します。                    |
    |--------------------+-----------------+----------------------------|
    |@xpt<数値>          |0〜127           |ポルタメントタイムを設定しま|
    |                    |                 |す。                        |
    |--------------------+-----------------+----------------------------|
    |@xpc<数値>          |0〜127           |ポルタメントコントロールを設|
    |                    |                 |定します。                  |
    |--------------------+-----------------+----------------------------|
    |p<数値>             |-8192〜8191      |ピッチベンドを設定します。  |
    +-------------------------------------------------------------------+


    ------------------------------------------------------------------------
    【18】ペダル制御

    +-------------------------------------------------------------------+
    |書式                |数値範囲         |説明                        |
    |--------------------+-----------------+----------------------------|
    |@xt<+|->            |なし             |ソステヌートをon(+)、 off(-)|
    |                    |                 |します。                    |
    |--------------------+-----------------+----------------------------|
    |@xs<+|->            |なし             |ソフトをon(+)、   off(-)しま|
    |                    |                 |す。                        |
    |--------------------+-----------------+----------------------------|
    |@xh<+|->            |なし             |ホールドをon(+)、 off(-)しま|
    |                    |                 |す。                        |
    +-------------------------------------------------------------------+




                                   - 15 -                            DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


    ------------------------------------------------------------------------
    【19】RPN,NRPN,データエントリー

    +-------------------------------------------------------------------+
    |書式                |数値範囲         |説明                        |
    |--------------------+-----------------+----------------------------|
    |@nr<10,16進数値>    |0x0000〜0x7f7f   |NRPNアドレスを選択します。  |
    |--------------------+-----------------+----------------------------|
    |@rp<10,16進表記>    |0x0000〜0x7f7f   |RPNアドレスを選択します。   |
    |--------------------+-----------------+----------------------------|
    |@dt<10,16進表記>    |0x0000〜0x7f7f   |データエントリー(16ビット)を|
    |                    |                 |mm,llの順に設定します。 効果|
    |                    |                 |は@dm,@dlを併用したもとと変 |
    |                    |                 |わりありません。            |
    |--------------------+-----------------+----------------------------|
    |@dm<10,16進表記>    |0x00〜0x7f       |データエントリー(上位8ビット|
    |                    |                 |)mmを設定します。           |
    |--------------------+-----------------+----------------------------|
    |@dl<10,16進表記>    |0x00〜0x7f       |データエントリー(下位8ビット|
    |                    |                 |)llを設定します。           |
    +-------------------------------------------------------------------+


    ------------------------------------------------------------------------
    【20】その他の制御

    +-------------------------------------------------------------------+
    |書式                |数値範囲         |説明                        |
    |--------------------+-----------------+----------------------------|
    |@xan                |なし             |オールノートオフを実行しま  |
    |                    |                 |す。                        |
    |--------------------+-----------------+----------------------------|
    |@xas                |なし             |オールサウンドオフを実行しま|
    |                    |                 |す。                        |
    |--------------------+-----------------+----------------------------|
    |@xr                 |なし             |リセットオールコントローラー|
    |                    |                 |を実行します。              |
    |--------------------+-----------------+----------------------------|
    |@xc<数値>           |0〜127           |トラックのチャンネルプレッシ|
    |                    |                 |ャーを設定します。          |
    |--------------------+-----------------+----------------------------|
    |@mn<数値>           |0〜16            |トラックのMONO数を設定しま  |
    |                    |                 |す。                        |
    |--------------------+-----------------+----------------------------|
    |@pl                 |なし             |トラックをPOLYに設定します。|
    |--------------------+-----------------+----------------------------|
    |_<数値>             |-127〜127        |<数値>    で指定されたノート|
    |                    |                 |数、移調します。            |
    |--------------------+-----------------+----------------------------|
    |_{ ... _}           |なし             |_{ から _} の間まで、 移調の|
    |                    |                 |影響を受けないようにします。|
    +-------------------------------------------------------------------+






                                   - 16 -                            DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC








                              第3章  実際の使用方法



    ○mplus.exeの使い方
          ここでは実際のcompileについて説明します。
          まず、   MMLファイルの拡張子は〜.mmdに統一してください。  たとえば
        inner.mmdというファイルを作成してコンパイルしたい場合、 次のように操
        作します。

        >mplus inner


        正常にコンパイルが行われた場合は、

    >music driver MFXDDN XMML3.00 compiler mPlus(mfxc+) version 1.00
    >copyright (c) 1991-94 by ABA / T.Kobayashi  and  Interfair  All  Rights
    >Reserved.
    >inner.mmd:
    >        obj(0):_main      in inner.mmd
    >        Fatal Error Messages: 0
    >        Warning     Messages: 0
    >
    >        Available memory  :  422656bytes.


          と表示されます。obj(?):.... in .... という表示は、"シリアル番号0に
        inner.mmdに記述されている_mainというオブジェクトを登録中です"という
        意味にとって下さい。 もちろん登録中に文法ミスなどが発生した場合、 エ
        ラーが表示されます。
          Fatal Error Messages  というのはコンパイル続行不能な致命的エラー、
        Warning Messages というのはコンパイルは続行可能だが、これでいいのか?
        という警告の事を示し、それぞれエラーが出現した数を表示しています。
          実際にエラーが出た場合のメッセージの見方について説明します。たとえ
        ば、 あるトラックに\というコマンド(このコマンドは存在しない)が使用さ
        れていたとします。するとコンパイル中には次のようなメッセージが表示さ
        れます。















                                   - 17 -                            DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


    >music driver MFXDDN XMML3.00 compiler mPlus(mfxc+) version 1.00
    >copyright (c) 1991-94 by ABA / T.Kobayashi  and  Interfair  All  Rights
    >Reserved.
    >inner.mmd:
    >        obj(0):_main      in fight.mmd
    >Error:inner.mmd(L00004) '\'は解釈不可能なMMLコマンドです。
    >        Fatal Error Messages: 1
    >        Warning     Messages: 0
    >
    >        Available memory  :  407440bytes.

          まず、Error:というのはFatal Errorのことを示します。Errorにはいくつ
        かのタイプがあり、コンパイル処理などに次のような影響を及ぼします。
        +--------------------------------------------------------------+
        |メッセージ          |種類                |対処方法            |
        |--------------------+--------------------+--------------------|
        |Error               |致命的エラー        |コンパイルは続行する|
        |                    |                    |が、オブジェクトを吐|
        |                    |                    |き出さない。  また、|
        |                    |                    |mplusは、  0以外のリ|
        |                    |                    |ターンコードを返す。|
        |--------------------+--------------------+--------------------|
        |Warning             |警告                |とりあえず値を補正  |
        |                    |                    |し、  コンパイルを続|
        |                    |                    |行。                |
        |--------------------+--------------------+--------------------|
        |System Error        |致命的システムエラー|その時点でコンパイル|
        |                    |                    |を強制中断。        |
        |--------------------+--------------------+--------------------|
        |System Warning      |システム警告        |そのままコンパイルは|
        |                    |                    |続行                |
        +--------------------------------------------------------------+

          次にファイル名とエラーが発生した行数を表示します。ここでは、inner.
        mmd(L00004)という表示なので、 inner.mmdの4行目でエラーが発生したぞ、
        という意味です。
          最後はエラーメッセージです。もし、その行にエラーがどうしても見つか
        らない場合、文の前後関係からエラーが発生することがありますので注意し
        てください。

          致命的エラーが無く特にオプション指定が無い場合、 ml.exe(オブジェク
        トリンカ)を呼び出して、 直接〜.mudファイル(演奏可能ファイル)を作成し
        ます。 ml.exeがpathの通ったディレクトリに存在しない場合、warningメッ
        セージが表示されてリンクされませんので、注意して下さい。ml.exeはpath
        の通ったディレクトリに格納しておくのがいいでしょう。

    ○mplus.exeオプション
          mplus.exeでは以下のオプションが使用可能です。










                                   - 18 -                            DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


             -c       コンパイルのみを行う
             -l(?)    リンカ(ml.exe)に、オプション -(?) を渡す。
             *.mbj    一緒にlinkする。
             -i(?)    #include 命令で参照されるディレクトリを指定する。
             -d,-x    デバッグモード


          -c オプションを指定すると、カレントディレクトリに〜.mbs,〜.mbjファ
        イルを作成します。
          -l オプションを利用すると、ml.exeの制御もできるようになります。 た
        とえばml.exeの〜.mudファイル最適化オプション -o を使用するときは -lo
        と指定することにより、利用することが出来ます。
          *.mbj は、ml.exeを呼び出したときに、これらを一緒に引き渡してリンク
        することができます。
          -i オプションは、#include で読み込みたいファイルが存在するディレク
        トリを指定します。TCCのように ; で区切っていくつも羅列することはでき
        ません(;;)。 いずれ対応したいですね。(例)-ia:\mplus\include このとき
        #include abc.mac とすると、 最初に  a:\mplus\include\abc.mac  を探し
        て、なかった場合カレントディレクトリを探します。

          なお、上記のオプションは、mplus.cfg に記述しておくことができます。
        例:mplus.cfgの内容

        >-ia:\mplus\include
        >-lo
        >-lu

          includeディレクトリを  a:\mplus\include にし、リンカに最適化オプシ
        ョンと、音色自動リンク機能を引き離すことを設定します。






                       第4章  謝辞及び著作権表示、使用条件など


    ○開発環境
          プログラム作成に、以下のアプリケーションを用いて作成しました。

             Machine PC9801RA21/Cx486DLC and P5-100M AT互換機  さんきゅ
             C++ Compiler       Turbo-C++ ver.1.01
             Assembler          Turbo Assembler ver.2.0
             Library manager    tlib.exe
             EXEfile linker     tlink.exe
             TEXT Editor        vz.com ver.1.57


          ドキュメント作成に、以下のアプリケーション用いて作成しました。

             TEXT formatter     ntf.exe
             Kanji code Filter  nkf (UNIX版)


          ntfで書くと、文章をぽんぽんかけるので非常にありがたいです(笑)。 作


                                   - 19 -                            DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


        者に tomoyuki niijimaさんに感謝いたします^^;。
          いろいろご助言下さった ISL-NETの方々に深く感謝いたします。

    ○利用条件
        以下の注意事項を良くお読みになって服用してください。

         o 著作権は小林 隆生及びInterfairが保有します。

         o このプログラムを実行して起こり得た損害について、 一切責任を負わな
           いものとします。 補償もしません。'95 7/1 からPL法が施行されるよう
           ですが、本プログラムもその対象となるならば、 その時点でサポートを
           一切打ち切ります(フリーソフトだから。シェアウェアならわからんでも
           ないが)。

         o ソースの改編後のuploadも許可します。  連絡は必要ありません。 ただ
           し、その旨をドキュメントに明確に書いてあることを条件とします...と
           しておいたのですが、面倒くさいのでやめます。 自分のつかいやすよう
           にパッチなどを当てて使用して下さい。

         o 転載する場合は、 本体・ソース・ドキュメントすべてを転載するように
           してください。 連絡は必要ありません。 でも、 もらったらうれしいな
           (笑)。

         o バグ修正は、最新版について行います。 ローカルバージョンには行いま
           せん(笑)。またバグ修正を行う義務は作者には一切ないものとします。

         o 組み込み後のプログラムの配布は、商的利用、 非商的利用どちらも構い
           ません。連絡不要です。でも、DOCファイルに書いてあったら結構嬉しい
           かも:)また、DDN,XDV単体での組み込みも構いません。

         o このソフトウェアは、Free Software として公開します。 一部のマクロ
           ファイルを除き、PDSではありません。取り扱いに注意して下さい。

        これらの条件を満たすものだけに許可します。

    ○連絡先

         ABA/小林 隆生  ISL-NET    isl30126
                        E-Mail     s95702@polaris.yatsushiro-nct.ac.jp
         TEANAN/山本 弘 NiftyServe HGA02466
                        ISL-NET    isl31480


    ○たわごと
          もし、このソフトウェアとかを気に入って下さった方は金欠の私(笑)にご
        寄付をよろしくお願いしますo(._.)o。 ご寄付で食べたりして、新しいもの
        を開発する意欲になりますから。

      肥後銀行八代駅前支店 普通口座 店番255 口座番号XXXXXXX 小林 隆生

        宜しくお願いいたします。


----------------------------------------------------------------------------
mPlus(mfxc+) compiler ver.1.10
                           Copyright (c) 1991,92,93,94 by T.Kobayashi and □


                                   - 20 -                            DIL1994




mPlus(mfxc+) user's manual                                       ver.1.18DOC


                                                           Interfair Lab. □
                                                     all rights reserved. □
























































                                   - 21 -                            DIL1994


