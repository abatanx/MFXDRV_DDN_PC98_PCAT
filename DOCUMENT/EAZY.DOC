

MFXDDN user's manual                                             ver.1.00DOC



eazy.doc
----------------------------------------------------------------------------
DOS汎用音源ドライバ
                     MFXDRV/DDN version 1.00 簡略説明書
            copyright (c) 1993,94 by T.Kobayashi / Interfair(DIL)
                            All Rights Reserved.

----------------------------------------------------------------------------






                               第1章  はじめに


      簡単な説明書です。これを読んでから、mfxddn.doc  を読むとより一層いろい
    ろ分かるかもしれません。






                               第2章  簡単な使い方


      まずはドライバの常駐です。これがないと始まりません。

    >mfxddn

    で、常駐します。

      まずは、サンプル曲を鳴らしてみましょう。sample.lzh の中に、melobox.mud
    という、 OPN/SSGに対応した曲データが入っています。なお、演奏可能なファイ
    ルの拡張子は、〜.mudです。

      このシステムでは、mfxddn.comを常駐しただけでは音をならしてくれません。
    音を鳴らす音源ドライバと、時間(テンポ)を計測するタイマドライバを組み込ん
    でやらなければならないのです。 まずは、 テンポ計測にインターバルタイマ、
    sample曲はOPN/SSGに対応しているので、 OPNとSSGの音源ドライバを組み込みま
    す。
      なお、ドライバは拡張子が 〜.xdv というファイルです。

    >mld opn,ssg,itvtimer

    これで、opn/ssgに対応している曲を鳴らすことが出来ます。

      これで準備が整いました。演奏しましょう。

    >mip melobox.mud

    で、鳴るはずです。ところで、他の曲を演奏しようとしたとき鳴ってくれないこ
    とがあるかもしれません。演奏しようとした曲が opn/ssg  に対応していないの


                                   - 1 -                             DIL1994




MFXDDN user's manual                                             ver.1.00DOC


    かもしれないので、 その曲のドキュメントを良く読んで mld でドライバを登録
    してあげてください。

      終わるときは

    >mfxddn /r

    で終わります。mld で登録したドライバも一緒に解放してくれます。メモリーか
    ら残らず消え去ってしまうので安心して下さい(笑)。






                             第3章  応用編(なにがだ)



3.1  bgmlib形式の、〜.bgm ファイルを鳴らしてみよう。

      フリーソフトウェアのいろいろな分野で活躍しているBEEP音源ライブラリ
    bgmlib [*1]形式のファイルを鳴らす技術を伝授します(笑)。

      まずは、    bgmlib形式の〜.bgmファイルを見つけましょう。    これを仮に
    "pippippi.bgm" と名付けます。さて、 このままではmfxdrv/ddnで鳴らすことが
    できません。 そこで、bgmlib形式のファイルを変換する bgm2mmd.exe をつかい
    ます。

    >bgm2mmd pippippi.bgm

    で、変換できます。うまく変換できないことがあるかもしれません。その時はエ
    ラーの起きた行数が表示されますから、その行を修正して下さい。

      うまくいくと、ファイルが pippip01.mmd pippip02.mmd .....  というふうに
    できあがります。〜.mmd というのは、mfxdrv/ddn標準mmlコンパイラ形式[*2]の
    MMLファイルです。 これを、MMLコンパイラ mplus.exe で演奏ファイルに変換し
    ます。

    >mplus pippip01.mmd

    で、コンパイルされます。

    うまくいったら、第1章のごとく鳴らしてみましょう。bgm2mmd は、曲をssgに変
    換してコンバートしますので、

    >mfxddn
    >mld ssg,itvtimer

    で、システムを常駐させて

-- note -----------------

 [*1] 現在は、master.lib に統合されています。

 [*2] XMML3.00形式 と呼んであげてください(笑)


                                   - 2 -                             DIL1994




MFXDDN user's manual                                             ver.1.00DOC


    >mip pippip01

    で演奏が開始されます。
      終わるときは、

    >mfxddn /r

    で OK です。
      ところで、MMLコンパイラ mplus.exe は、悲しいことにワイルドカードに対応
    していないので、bgm2mmdで、mmdファイルがたくさんできたときは、１個１個地
    道にコンパイルしてください(ｺﾞﾒﾝﾈ szﾟ)。


3.2  標準MIDIファイル(〜.mid)を鳴らしてみよう。

      MFXDRV/DDNは、MIDIをもならせるパワーを持ってます。もちろん像が踏んでも
    壊れません(意味不明)。鳴らしてみましょう。もちろん  MIDI機器(GS音源とか)
    は必要です。
      まず、適当なところから 〜.mid を持ってきて下さい。sample.lzhの中にいろ
    いろはいってますが、他から気に入った曲をもってきた方が良いでしょう(笑)。
    レコンポーザー形式(〜.rcp)は、cvs.exe [*3]などでコンバートしてください。
    さて、コンバートしたい標準MIDIファイルを、仮に "gerogero.mid" と名付けま
    す。 この 〜.midというファイルの形式は、このままでは演奏できません。そこ
    で、mcv.exe と、ml.exeというプログラムが必要です。mcv.exe は、標準MIDIフ
    ァイルコンバーターで、ml.exe はmudを作るプログラムです。ml.exeは、カレン
    トディレクトリか、パスの通ったディレクトリに置いて下さい。

      さて、

    >mcv gerogero

    でコンバートします。うまくいくと、gerogero.mudができあがります。
      さて、鳴らしてみましょう。mcv.exe は、曲をMIDIとしてコンバートしますの
    で、

    >mfxddn
    >mld midi,itvtimer

    で、システムを常駐させて

    >mip gerogero

    で演奏が開始されます。
      終わるときは、

    >mfxddn /r

    で OK です。





-- note -----------------

 [*3] Hajime Koike氏のフリーソフトウェアです。


                                   - 3 -                             DIL1994




MFXDDN user's manual                                             ver.1.00DOC








                            第4章  ヤクザなつかいかた



      ところで、    なんでわざわざ外部のドライバを登録してやらなきゃいけんの
    かー、とお怒りの方もいるかも[*4]しれません。でも、これはこれで利点があり
    ます。それを説明しましょう。

      まず、〜.xdvというドライバは、すべてDRVID [*5]という名札みたいなものを
    持っています。例をあげると、midi.xdvは"MIDI"、ssg.xdvは"SSG"、 opn.xdvは
    "OPN"、 itvtimer.xdvは"ITVTIMER98"といった感じです。ということは、この名
    札を書き換えてやると、曲データをごまかして演奏できるかもしれないですね。
    演奏できるんですよ、これが(わっはっは←バカ)。DRVIDの知り方は、 ドライバ
    のドキュメントを読むか、 xdvファイルをmielとかfdとかのファイラーで覗くな
    どすると、分かると思います。ファイラーで覗いたときは、そのファイルの最初
    の方にかいてあります。

      さて、大抵のドライバに /id  というオプションが用意されていると思います
    が、 これは、DRVIDを指定された名前に変更するというものです。これをつかっ
    て先ほど OPNとSSGで演奏させた"melobox.mud"をBEEPで演奏してみましょう。
      なお、OPNパートのみを演奏させてみます。まずは、ドライバを常駐。

    >mfxddn


    次がミソです。

    >mld beep /id=OPN,itvtimer

    これで、beep.xdvとopn.xdvをごまかしました。つまり、 名札(DRVID)はOPNなの
    に中身はBEEPというドライバです。たとえるならば、偽造運転免許証を持った無
    免許運転者ってとこですね(意味不明)。
      さて、重要な名札にもう一つ、DRVCH [*6]というものがあり、これはドライバ
    または音源が演奏できる最大のチャンネル数のことです。たとえばmidi.xdvなら
    16チャンネル、 opn.xdv、 ssg.xdvなら3チャンネルといった具合です。 BEEPで
    は、デフォルトでDRVCHが 1 です。beep.xdvは特殊で、 時分割で音をならす(分
    散発声)をおこなうことができるので、 この最大発音チャンネル数を増やすこと
    が出来ます。そのオプションが /ch です。なお、/ch オプションは、 対応して
    いないドライバが多いかも。OPNは普通3チャンネルで演奏するので、beepもなん
    とかして3チャンネルならしましょう。つまり、演奏可能チャンネル数を3チャン
    ネルにしてしまえばいいのです。
      上から順に実験しているひとなら、いま、beep.xdvが組み込まれている筈なの
-- note -----------------

 [*4] いるかなぁ...(笑)

 [*5] DRiVer's IDentification の略です。

 [*6] DRiVer's usable maximum  CHannel(ドライバの使用可能最大チャンネル)の略
      です。


                                   - 4 -                             DIL1994




MFXDDN user's manual                                             ver.1.00DOC


    でとりあえず、 組み込みなおします。実験してない人は、mfxddn の行からどう
    ぞ。

    >mfxddn /r
    >mfxddn

    それで、ここからミソですね。

    >mld beep /id=OPN /ch=3,itvtimer

    これで、okです。
      さぁ演奏してみましょう。

    >mip melobox

    BEEPで鳴っていますか? やーすごいですね(笑)。同じように、MIDIでも鳴らすこ
    とが出来ます。

    >mld midi /id=OPN,itvtimer

    に変更するだけです。なお、 同じDRVIDのドライバを組み込もうとしたときメッ
    セージが表示されて組み込めません。一度 mfxddn.com を解放してから組み込み
    なおして下さい。



































                                   - 5 -                             DIL1994




MFXDDN user's manual                                             ver.1.00DOC








                             第5章  曲もかいてみる。



      むぅ、ただならすだけならバカでもできます(うそ)。というわけで、なにか曲
    を書いてみましょう。 そこで必要なのが mplus.exe という標準XMMLコンパイラ
    です。
      最初から難しい曲もなんですから、チューリップを書いてみましょう。エディ
    ターで下のモノを打ち込んで下さい。

    例)chu.mmd

    >#title チューリップのうた。
    >.object _main
    >MELODY=BEEP(0);
    >{
    >       MELODY   t120l4o5q90;
    >       MELODY   cde2 cde2;
    >       MELODY   gedcded2;
    >       MELODY   cde2 cde2;
    >       MELODY   gedcdec2;
    >       MELODY   ggegaag2;
    >       MELODY   eeddc1;
    >}

      最初は、中身が分からなくても構いません。とにかく鳴らしてみます。
      まずは、コンパイルです。 さてコンパイルするために必要なモノは、 mplus.
    exe  とml.exe です。この2つは必須です。なお、ml.exe は、必ずカレントディ
    レクトリか、パスの通ったディレクトリに置いて下さい。

     A>mplus chu
     music driver MFXDDN XMML3.00 compiler mPlus(mfxc+) version 1.xx
     copyright (c) 1991-94 by ABA / T.Kobayashi and Interfair All Rights Reserved.
     chu.mmd:
             obj(0):_main      in chu.mmd
      compiled :chu.mmd(L00013,100%)
             Fatal Error Messages: 0
             Warning     Messages: 0

             Available memory  :  378720bytes.

     music driver MFXDDN XMML3.00 object linker ML version 2.41
     copyright (c) 1993 by ABA / T.Kobayashi and Interfair All Rights Reserved.
     chu.mud:
     No_ Objectname__________ Filename____________
       0 _main                j:\chu.mbj
             Available memory  :  301504bytes.

     A>



                                               - 6 -                                         DIL1994




MFXDDN user's manual                                             ver.1.00DOC



      うまくコンパイルできると、上のようなメッセージが出ます。またエラーの時
    は、

     music driver MFXDDN XMML3.00 compiler mPlus(mfxc+) version 1.xx
     copyright (c) 1991-94 by ABA / T.Kobayashi and Interfair All Rights Reserved.
     chu2.mmd:
             obj(0):_main      in chu2.mmd
     Error:chu2.mmd(L00005) 'MeLODY' というトラックは存在しません。
     Error:chu2.mmd(L00005) 't120l4o5q90' というトラックは存在しません。
      compiled :chu2.mmd(L00013,100%)
             Fatal Error Messages: 2
             Warning     Messages: 0

             Available memory  :  378720bytes.

    などとエラーがでて、コンパイル動作が終了します。(L00005)とかありますが、
    この行がエラーのある行なのでここを調べてもういちどコンパイルしましょう。

      さて、コンパイルに成功すると、mudファイルができます。 前述の通りのchu.
    mmdなら、BEEP音源に対応していますので、mfxddn と
     mld beep としてシステムを常駐させて、mip chu で演奏させてみて下さい。き
    っと鳴るはずです。

      とまぁ、 手順はだいたいこのような感じですが、chu.mmdファイルの内容につ
    いて簡単に説明します。ねないでね(笑)。

      まず、#title というのは、曲のタイトルを設定します。 べつに有っても無く
    ても構いません。 他にも作曲者を設定する #composer や、編曲者の #arranger
    などいろいろあります。そこんところは、mplus.doc を見て下さい。

      さて、次。.object ... です。うーん、.object _main 〜{〜}と、大まかにみ
    てみましょう。すると、{〜} の中に MELODY  という文字がはいっていますね。
    XMMLでは、.object  〜 {〜} で{と} の間に曲を書かないといけません。これは
    決まりです。まぁ、意味としては_main という名前の譜面に {〜} という曲を書
    きますよっ、という感じで捉えておいてください。なお、_main は、_main でな
    いといけません。_main を _baka  とかに変えると曲が正しく生成できません。
    しつこいようですが、かならず _main です(笑)。

      ところで、.object  _main から { の間に、MELODY=BEEP(0); という行があり
    ます。だいたい予測がつくと思いますが、この間で、MELODYのトラック  をBEEP
    のチャンネル0でならしなさいということをあらかじめ指定します。 もちろん、
    SSG で鳴らしたければ MELODY=SSG(0);とか設定できます。 チャンネル番号は、
    DRVCH-1  までの数で指定して下さい。つまりSSGが3チャンネルならせるなら、0
    〜2 までの 3つ...ということです。
      さて、MELODY=BEEP(0),SSG(0); という書き方もできます。 これはいったいな
    んなんでしょうか。 これは、BEEPが登録されてなければSSGでならしなさいとい
    う意味です。この書き方は4レベルまで指定できます。つまり、MELODY=MIDI(0),
    OPN(0),SSG(0),BEEP(0); というような書き方ができるわけです。他にも  *COND
    *SOUND OFF などがありますが、これらはmplus.doc を見て下さい。

      {〜}  の中身に移ります。書き方は、[トラック名] [MML列]; という感じにな
    ります。ここでは、MELODY t120l4o5q90; とかがこれに相当します。この行が実
    際に演奏されるところになります。...というわけで、次に、MML列の説明に移り
    ます。
      BASICなどでMMLを使ったことがあるひとなら、簡単に理解できるでしょう。ま


                                   - 7 -                             DIL1994




MFXDDN user's manual                                             ver.1.00DOC


    ず、t テンポの設定を行います。l は、デフォルト音長。ここでは、 4分音符で
    す。 o  は、 オクターブ。qは、ゲートタイムというもので実際の発音時間の設
    定。単位は % です。ここでは、90% です。発音はお馴染みの c,d,e,f,g,a,b。c
    から順に、ドレミファソラシドに相当します。rは休符です。chu.mmd  をみると
    たまに  c2 とかありますね。これは、この音だけは2分音符で鳴らせ、、、とい
    う意味になります。この数字を省略した場合、先ほどでてきた、デフォルト音長
    設定 l で決めた音長になります。

      ざっと説明すると、 このような感じになりますがいかがでしょうか。 mplus.
    exe は、BEEPだけでなくMIDIも完全にコントロールできるような仕様になってま
    すし、マクロ機能などもかなり強力です。しかし、ちょっと遅いのが玉にキズで
    すが(爆死)。 詳しくは、わかりにくい mplus.doc を見て下さい(笑)。他にも沢
    山の MMLコマンドがありますので、全部つかってみましょう(おい)。













































                                   - 8 -                             DIL1994




MFXDDN user's manual                                             ver.1.00DOC








                            第6章  というわけで・・・


      おおざっぱに説明してみましたが、いかがでしょうか。使えば使うほどいまま
    での音源ドライバにないあやしいことが可能ですので、ちょっと複雑ですが、頑
    張ってマスターしてみてください。各ドキュメントが、ちょっとばかり専門的に
    なってますが、わかりにくいところや全然わからんところ(笑)は、 私(ABA)の方
    へmailを下されば、できるだけおこたえしますので、これからもよろしくお願い
    します。











































                                   - 9 -                             DIL1994




MFXDDN user's manual                                             ver.1.00DOC








                     第7章  謝辞及び著作権表示、使用条件など


    ○開発環境
          プログラム作成に、以下のアプリケーションを用いて作成しました。

             Machine PC9801RA21/Cx486DLC and P5-100M AT互換機  さんきゅ
             C++ Compiler       Turbo-C++ ver.1.01
             Assembler          Turbo Assembler ver.2.0
             Library manager    tlib.exe
             EXEfile linker     tlink.exe
             TEXT Editor        vz.com ver.1.57


          ドキュメント作成に、以下のアプリケーション用いて作成しました。

             TEXT formatter     ntf.exe
             Kanji code Filter  nkf (UNIX版)


          ntfで書くと、 文章をぽんぽんかけるので非常にありがたいです(笑)。作
        者に tomoyuki niijimaさんに感謝いたします^^;。
          いろいろご助言下さった ISL-NETの方々に深く感謝いたします。

    ○利用条件
        以下の注意事項を良くお読みになって服用してください。

         o 著作権は小林 隆生及びInterfairが保有します。

         o このプログラムを実行して起こり得た損害について、 一切責任を負わな
           いものとします。 補償もしません。'95 7/1 からPL法が施行されるよう
           ですが、本プログラムもその対象となるならば、 その時点でサポートを
           一切打ち切ります(フリーソフトだから。シェアウェアならわからんでも
           ないが)。

         o ソースの改編後のuploadも許可します。  連絡は必要ありません。 ただ
           し、その旨をドキュメントに明確に書いてあることを条件とします...と
           しておいたのですが、面倒くさいのでやめます。 自分のつかいやすよう
           にパッチなどを当てて使用して下さい。

         o 転載する場合は、 本体・ソース・ドキュメントすべてを転載するように
           してください。 連絡は必要ありません。 でも、 もらったらうれしいな
           (笑)。

         o バグ修正は、最新版について行います。 ローカルバージョンには行いま
           せん(笑)。またバグ修正を行う義務は作者には一切ないものとします。

         o 組み込み後のプログラムの配布は、商的利用、 非商的利用どちらも構い
           ません。連絡不要です。でも、DOCファイルに書いてあったら結構嬉しい
           かも:)また、DDN,XDV単体での組み込みも構いません。


                                   - 10 -                            DIL1994




MFXDDN user's manual                                             ver.1.00DOC


         o このソフトウェアは、Free Software として公開します。 一部のマクロ
           ファイルを除き、PDSではありません。取り扱いに注意して下さい。

        これらの条件を満たすものだけに許可します。

    ○連絡先

         ABA/小林 隆生  ISL-NET    isl30126
                        E-Mail     s95702@polaris.yatsushiro-nct.ac.jp
         TEANAN/山本 弘 NiftyServe HGA02466
                        ISL-NET    isl31480


    ○たわごと
          もし、このソフトウェアとかを気に入って下さった方は金欠の私(笑)にご
        寄付をよろしくお願いしますo(._.)o。ご寄付で食べたりして、 新しいもの
        を開発する意欲になりますから。

      肥後銀行八代駅前支店 普通口座 店番255 口座番号XXXXXXX 小林 隆生

        宜しくお願いいたします。


----------------------------------------------------------------------------
                           Copyright (c) 1991,92,93,94 by T.Kobayashi and □
                                                           Interfair Lab. □
                                                     all rights reserved. □































                                   - 11 -                            DIL1994


